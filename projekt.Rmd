---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Brina Ribič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

Analizirala bom bruto povprečne plače v Sloveniji in Evropi. Osredotočila se bom na to, kako se plače v Sloveniji razlikujejo glede na statistično regijo, spol in starost. Skušala bom poiskati povezave med rastjo povprečnih plač in BDP skozi obdobje 2008-2018. Pogledala si bom, kako se povprečne plače razlikujejo med evropskimi državami in jih primerjala z plačami po statističnih regijah v Sloveniji. Zopet bom pogledala, če je kakšna povezava med gibanjem BDP na prebivalca in povprečnimi plačami za države v Evropi.


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz1.r", encoding="UTF-8")
```
  
Podatke sem uvozila iz SURS-a v obliki CSV, iz Wikipedije v obliki HTML in iz Eurostata v obliki CSV. Podatke imam v štirih razpredelnicah:

1. `place_SLO` - podatki o plačah v Sloveniji glede na statistično regijo, spol in starost
   - `Leto`: spremenljivka: leta od 2008 do 2018 (število)
   - `Regija` spremenljiva: ime statistične regije (niz)
   - `Spol` spremenljivka: (niz: moski, zenske)
   - `Starost` spremenljivka: (niz: po starostnih skupinah od 15 do 64 let, vsaka skupina          vsebuje 10 let)
   - `Placa` meritev: plače (število)
   
Graf prikazuje plače v regijah glede na starost za leto 2018.

```{r graf1, fig.align='center'}
ggplot(place_SLO %>% 
         filter(Leto == 2018) %>% 
         group_by(Starost, Regija) %>% 
         summarise(Povprecje=mean(Placa)), aes(x=Regija, y=Povprecje, fill=factor(Starost))) + 
  geom_col(position = "dodge") + 
  labs(title="Plače po regijah glede na starost za leto 2018", fill="Starost") + 
  xlab("Statistična regija") + 
  ylab("Plača (v EUR)") +
  theme(axis.text.x=element_text(size=10, hjust=0.95, angle=45)) +
  scale_fill_brewer(palette="Dark2")

```

2. `bdp_SLO` - podatki o BDP v statističnih regijah v Sloveniji
   - `Leto`: spremenljivka: obdobje (število: od 2008 do 2018)
   - `Regija` spremenljiva: ime statistične regije (niz)
   - `BDP` meritev: BDP v milijonih EUR (število)
   
3. `bdp_regije` - podatki BDP na prebivalca v statističnih regijah v Sloveniji
   - `Leto`: spremenljivka: obdobje (število: od 2008 do 2018)
   - `Regija` spremenljiva: ime statistične regije (niz)
   - `BDP_na_prebivalca` meritev: BDP na prebivalca v EUR (število)
   
4. `place_Evropa` - podatki o plačah za posamezne države v Evropi
   - `Leto` spremenljivka: obdobje(število: 2008-2018)
   - `Drzava` spremenljivka: države v Evropi (niz)
   - `Placa` meritev: povprečna bruto plača v EUR (število)

Spodnji graf prikazuje plače evropskih držav, kjer vertikalna črta prikazuje povprečno plačo v Evropi.
   
```{r graf2, fig.align='center'}
ggplot(place_Evropa %>% 
         filter(Leto == 2018) %>% 
         mutate(pogoj=if_else(Drzava == "Slovenia", "slo", "nic")), 
       aes(x=Placa, y=reorder(Drzava, -Placa), fill=pogoj)) + 
  geom_col() + 
  geom_vline(xintercept = mean(place_Evropa$Placa), col="dark blue") + 
  labs(title = "Plače v Evropskih državah za leto 2018") + 
  xlab("Plače (EUR)")+ ylab("Država") + scale_fill_brewer(palette="Dark2") + 
  theme(legend.position = "none")

```

   
5. `bdp_Evropa` - podatki o BDP in v evropskih državah
   - `Leto` spremenljivka: obdobje (število: od 2008 do 2018)
   - `Drzava` spremenljivka: države v Evropi (niz)
   - `BDP` meritev: BDP v milijonih EUR (število)
   
6. `bdp_pc_Evropa` - podatki o BDP na prebivalca v evropskih državah
   - `Leto` spremenljivka: obdobje (število: od 2008 do 2018)
   - `Drzava` spremenljivka: države v Evropi (niz)
   - `BDP_na_prebivalca` meritev: BDP na prebivalca v EUR (število)
   
# Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Spodnji zemljevid prikazuje povprečne plače v posameznih regijah. Razvidno je, da so najnižje plače v zasavski regiji, najvišje pa v osrednjeslovenski, kar bi tudi pričakovala, saj je tukaj glavno mesto. Zanimivo se mi zdi, da imamo v posavju najvišje plače v Sloveniji. Sklepam, da povprečje dvigujejo plače v NEK.
```{r zemljevid1, fig.align='center'}
print(zemljevid.plac)
```

V preteklosti so bile razlike med spoli zelo velike na vseh področjih. To se seveda pozna tudi pri plačah. Iz spodnjega grafa je razvidno, da se ta razlika zmanjšuje. Opazim pa tudi, da so plače pri moških bolj nihale  kot pa pri ženskah, pri le teh v opazovanem obdobju zgolj naraščajo. 
```{r graf3, fig.align='center'}
print(graf.spol)
```

Spodnja dva grafa prikazujeta plače in BDP na prebivalca v regijah z najvišjimi plačami in regiji z najnižjimi plačami.
```{r graf45, figures-side, fig.show="hold", out.width="50%"}
print(graf.bdp)
print(graf.plac)
```



***





