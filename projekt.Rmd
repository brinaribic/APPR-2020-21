---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Brina Ribič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

Analizirala bom bruto povprečne plače v Sloveniji in Evropi. Osredotočila se bom na to, kako se plače v Sloveniji razlikujejo glede na statistično regijo, spol in starost. Skušala bom poiskati povezave med rastjo povprečnih plač in BDP skozi obdobje 2008-2018. Pogledala si bom, kako se povprečne plače razlikujejo med evropskimi državami in jih primerjala z plačami po statističnih regijah v Sloveniji. Zopet bom pogledala, če je kakšna povezava med gibanjem BDP na prebivalca in povprečnimi plačami za države v Evropi.


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```
  
Podatke sem uvozila iz SURS-a v obliki CSV, iz Wikipedije v obliki HTML in iz Eurostata v obliki CSV. Podatke imam v štirih razpredelnicah:

1. `place_SLO` - podatki o plačah v Sloveniji glede na statistično regijo, spol in starost
   - `LETO`: spremenljivka: leta od 2008 do 2019 (število)
   - `STATISTICNA_REGIJA` spremenljiva: ime statistične regije (niz)
   - `SPOL` spremenljivka: (niz: moski, zenske)
   - `STAROST` spremenljivka: (niz: po starostnih skupinah od 15 do 64 let, vsaka skupina          vsebuje 10 let)
   - `PLACE` meritev: plače (število)
   
Graf prikazuje plače v regijah glede na starost za leto 2019.

```{r graf1, fig.align='center'}
ggplot(place_SLO %>% 
         filter(LETO == 2019) %>% 
         group_by(STAROST, STATISTICNA_REGIJA) %>% 
         summarise(POVPRECJE=mean(PLACE)), aes(x=STATISTICNA_REGIJA, y=POVPRECJE, fill=factor(STAROST))) + 
  geom_col(position = "dodge") + 
  labs(title="Plače po regijah glede na starost za leto 2019", fill="Starost") + 
  xlab("Statistična regija") + 
  ylab("Plača (v EUR)") +
  theme(axis.text.x=element_text(size=10, hjust=0.95, angle=45)) +
  scale_fill_brewer(palette="Dark2")

```

2. `bdp_regije` - podatki o BDP in BDP na prebivalca v statističnih regijah v Sloveniji
   - `LETO`: spremenljivka: obdobje (število: od 2008 do 2018)
   - `STATISTICNA_REGIJA` spremenljiva: ime statistične regije (faktor)
   - `BDP` meritev: BDP v milijonih EUR (število)
   - `BDP_na_prebivalca` meritev: BDP na prebivalca v EUR (število)

   
Tabela ni v obliki *tidy data*, ker imam dve meritvi v eni tabeli. Če bi želela imeti v *tidy data* bi morala iz tabele `bdp_regije` narediti dve ločeni tabeli, prva bi vsebovala vse spremenljivke in celotni BDP, druga pa tudi vse spremenljivke in BDP na prebivalca.
   
3. `place_Evropa` - podatki o plačah za posamezne države v Evropi
   - `LETO` spremenljivka: obdobje(število: 2008-2018)
   - `DRZAVA` spremenljivka: države v Evropi (niz)
   - `PLACE` meritev: povprečna bruto plača v EUR (število)

Spodnji graf prikazuje plače evropskih držav, kjer vertikalna črta prikazuje povprečno plačo v Evropi.
   
```{r graf2, fig.align='center'}
ggplot(place_Evropa %>% 
         filter(LETO == 2018) %>% 
         mutate(pogoj=if_else(DRZAVA == "Slovenia", "slo", "nic")), 
       aes(x=PLACE, y=DRZAVA, fill=pogoj)) + 
  geom_col() + 
  geom_vline(xintercept = mean(place_Evropa$PLACE), col="dark blue") + 
  labs(title = "Plače v Evropskih državah za leto 2018") + 
  xlab("Plače (EUR)")+ ylab("Država") + scale_fill_brewer(palette="Dark2") + 
  theme(legend.position = "none")

```

   
4. `bdp_skupaj` - podatki o BDP in BDP na prebivalca v evropskih državah
   - `LETO` spremenljivka: obdobje (število: od 2008 do 2018)
   - `DRZAVA` spremenljivka: države v Evropi (niz)
   - `BDP` meritev: BDP v milijonih EUR (število)
   - `BDP_na_prebivalca` meritev: BDP na prebivalca v EUR (število)
   

***





